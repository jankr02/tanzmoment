<div [class]="containerClasses.join(' ')">
  <label class="checkbox__wrapper" [for]="id || name">
    <!-- Hidden native checkbox for accessibility -->
    <input
      type="checkbox"
      [id]="id || name"
      [name]="name"
      [checked]="checked"
      [disabled]="disabled"
      [required]="required"
      [attr.aria-describedby]="
        shouldShowHelperText ? (id || name) + '-helper' : null
      "
      [attr.aria-invalid]="hasError ? 'true' : null"
      (change)="toggle()"
      (focus)="onFocus()"
      (blur)="onBlur()"
      class="checkbox__input"
    />

    <!-- Custom checkbox box -->
    <span class="checkbox__box" [attr.aria-hidden]="true">
      <!-- Checkmark icon -->
      @if (checked && !indeterminate) {
        <svg
          class="checkbox__checkmark"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="3"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
      }

      <!-- Indeterminate icon -->
      @if (indeterminate) {
        <svg
          class="checkbox__indeterminate"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="3"
          stroke-linecap="round"
        >
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
      }
    </span>

    <!-- Label text -->
    @if (label) {
      <span class="checkbox__label">
        {{ label }}
        @if (required) {
          <span class="checkbox__required-indicator">*</span>
        }
      </span>
    }
  </label>

  <!-- Helper/Error Text -->
  @if (shouldShowHelperText) {
    <p
      [id]="(id || name) + '-helper'"
      class="checkbox__helper-text"
      [class.checkbox__helper-text--error]="hasError"
      role="alert"
      [attr.aria-live]="hasError ? 'assertive' : 'polite'"
    >
      {{ displayText }}
    </p>
  }
</div>
